워드프레스가 설치된 디렉토리에 접근해 파일 목록을 살펴보면 `.htaccess`라는 숨겨진 파일이 있다.[^1] 이 파일은 아파치 웹서버가 디렉토리마다 각각 별도의 설정을 할 수 있게 해 주는 장치이다. 

아파치 서버 설정 어딘가에는 보통 워드프레스의 디렉토리에 대해 다음과 같은 설정을 해 둔다.

```httpd
<Directory "/path/to/wordpress">
# ... (생략) ...

AllowOverride All

# ... (생략) ...
</Directory>
```

`AllowOverride`를 'All'로 맞춰 주었다. 워드프레스 디렉토리 `/path/to/wordpress` 내부의 파일에 웹서버가 접근할 때 `.htaccess` 파일을 읽어 아파치 서버의 전역 설정을 일부 변경할 수 있도록 허용한다는 뜻이다.

워드프레스 디렉토리 `/path/to/wordpress`에 위치한 `.htaccess` 파일에는 보통 다음과 같은 코드가 발견된다. 

```
1  # BEGIN WordPress
2  <IfModule mod_rewrite.c>
3  RewriteEngine On
4  RewriteBase /
5  RewriteRule ^index\.php$ - [L]
6  RewriteCond %{REQUEST_FILENAME} !-f
7  RewriteCond %{REQUEST_FILENAME} !-d
8  RewriteRule . /index.php [L]
9  </IfModule>
10 # END WordPress
```

설명의 편의를 위해 각 줄의 처음에 줄 번호를 붙였다.
- 1, 10번 줄은 주석이다. 서버에 아무런 영향을 미치지 않는다. 
- 2, 9번 줄은 IfModule 지시자를 선언한다.
	- 아파치의 rewrite 모듈이 활성화 되어 있다면 지시자 내의 명령을 읽는다.
	- rewrite 모듈은 URL 다시쓰기를 담당한다. URL의 특정한 문자열을 캐치해서 다른 방식으로 변경하는 기능이다.
- 3번 줄은 rewrite를 사용하겠다는 명령
- 4번 줄은
- 5번 줄은 경로가 정확하게 `index.php`라면 그대로 놔두고 과정을 멈춘다는 뜻이다. 이 경우라면 6번으로 넘어가지 않는다.  
- 6번 줄은 "요청 받은 경로가 실제 존재하는 파일이 아닌 경우라면"이란 뜻이다.
- 7번 줄은 "요청 받은 경로가 실제 존재하는 디렉토리가 아니라면"이란 뜻이다.
- 8번 줄은 6, 7번 줄의 조건이 맞는 경우 실행되는 규칙이다.
	- 현재 모든 경로를 무시하고 경로를 `/index.php`로 새로 다시 쓴다.

즉 웹브라우저에 `https://my-site.com/post/my-post`라는 URL을 넣으면, 아파치 웹서버에서 URL 다시 쓰기를 진행해 실제로는 `/post/my-post`가 아닌 `/index.php`로 접속하게 한다. 단, `/post/my-post`가 웹서버에 실제로 존재한다면. 만약 이 경우라면 해당 파일 또는 디렉토리를 처리한다.

결과적으로 서버에 가상적으로 존재하는 모든 경로에 대해서는 해당 경로는 죄다 무시하고 `index.php`로 접속하라는 뜻이다. 왜 가상의 경로를 무시하는가? 이유는 이렇다. URL을 새로 쓰게 되더라도 서버의 환경 변수에 방문자가 방문한 원래 경로의 정보는 고스란히 기록되어 있다. 이 정보를 기반으로 워드프레스는 자체적으로 가상 경로에 대해 약속된 응답을 돌려준다. 아파치 웹서버의 파일, 디렉토리 기반의 고정된 규칙이 아닌, 워드프레스가 소프트웨어적으로 코딩 가능한 규칙을 적용하기 위해 이런 다시 쓰기 규칙을 사용하는 것이다.

이렇게 소프트웨어적으로 유연하게 설정할 수 있게 규칙을 쓰는 행위를 소프트 플러시(soft flush)라고 한다. 반면 .htaccess 에 먼저 기록된 다시 쓰기 규칙을 수정하는 행위를 하드 플러시(hard flush)라고 한다.

소프트 플러시에 대해 하드 플러시가 우선하므로 최우선적으로 다시 쓰기 규칙이 적용되어야 할 때 하드 플러시를 사용한다. 예를 들어 `/wp-admin/admin-ajax.php` 같은 경로에 대해 다시 쓰기를 지정하는 경우, 워드프레스는 하드 플러시를 사용해 `.htaccess` 파일에 다시 쓰기 규칙을 기록한다.


[^1]: UNIX 또는 GNU/Linux 에서는 쉘에서 `ls` 명령에 `-a` 옵션을 더해야 이 파일이 보인다.

